INCLUDE "emu8086.inc"

TAMANHO EQU 32

org 100h

DEFINE_GET_STRING
DEFINE_PRINT_STRING
    
    INICIO:
    CALL CLEAR_SCREEN
    
    MOV SI, OFFSET ALUNO
    CALL PRINT_STRING
    CALL PULA_LINHA
     
    MOV SI, OFFSET ALUNO1
    CALL PRINT_STRING
    CALL PULA_LINHA
    
    MOV SI, OFFSET ALUNO2
    CALL PRINT_STRING
    CALL PULA_LINHA
    
    MOV SI, OFFSET ALUNO3
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA

    MOV SI, OFFSET CACA_PALAVRAS
    CALL PRINT_STRING
    CALL PULA_LINHA
    
    CALL PULA_LINHA
    MOV  COR, 7
    CALL IMPRIMIR_CACA_PALAVRAS_INICIO
    
    CALL PULA_LINHA
    MOV SI, OFFSET ENTRE_COM_UMA_STRING
    CALL PRINT_STRING
    
    MOV DI, OFFSET PALAVRA
    MOV DX, TAMANHO + 1
    CALL GET_STRING
    
    CALL CONTAR_PALAVRA_ENTRADA 
    
    CALL CLEAR_SCREEN
    JMP INTERFACE
    

;IMPRIME CACA PALAVRAS NO INICIO    
IMPRIMIR_CACA_PALAVRAS_INICIO: 
    PUSHF
    PUSH AX 
    PUSH SI
    PUSH DX 
    MOV SI, OFFSET INICIO_A
    INC SI
BUSCA_IMPRIME_CACA_PALAVRAS_INICIO:  
    MOV DH, [SI]       
    CMP DH, "@"
    JE  PULA_LINHA_CACA_PALAVRAS_INICIO
    CMP DH, "*"
    JE  SAIDA_IMPRIME_CACA_PALAVRAS_INICIO
    CALL IMPRIMIR_LETRA
    INC SI
    JMP BUSCA_IMPRIME_CACA_PALAVRAS_INICIO
PULA_LINHA_CACA_PALAVRAS_INICIO:
    ADD SI, 2 
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP  BUSCA_IMPRIME_CACA_PALAVRAS_INICIO
SAIDA_IMPRIME_CACA_PALAVRAS_INICIO:
    POP DX 
    POP SI
    POP AX
    POPF
    RET

    
;INICIO INTERFACE                                          
OPCAO_INTERFACE:
    POP DX
    POP DI
    POP SI
    CALL CLEAR_SCREEN
INTERFACE:
    PUSH DX
    PUSH DI
    PUSH SI
    MOV  OPCAO, 00
    MOV  SI, OFFSET OPCAO1
    CALL PRINT_STRING
    CALL PULA_LINHA
    MOV  SI, OFFSET OPCAO2
    CALL PRINT_STRING
    CALL PULA_LINHA
    MOV  SI, OFFSET OPCAO3
    CALL PRINT_STRING
    CALL PULA_LINHA      
    MOV  SI, OFFSET OPCAO4
    CALL PRINT_STRING
    CALL PULA_LINHA 
    MOV  SI, OFFSET OPCAO5
    CALL PRINT_STRING
    CALL PULA_LINHA  
    MOV  SI, OFFSET OPCAO6
    CALL PRINT_STRING
    CALL PULA_LINHA
    MOV  SI, OFFSET OPCAO7
    CALL PRINT_STRING
    CALL PULA_LINHA
    MOV  SI, OFFSET OPCAO8
    CALL PRINT_STRING
    CALL PULA_LINHA
    MOV  SI, OFFSET OPCAO9
    CALL PRINT_STRING
    CALL PULA_LINHA
    MOV  SI, OFFSET OPCAO10
    CALL PRINT_STRING
    CALL PULA_LINHA
    MOV  SI, OFFSET OPCAO0
    CALL PRINT_STRING
    CALL PULA_LINHA 
    MOV  SI, OFFSET ESCOLHA
    CALL PRINT_STRING 
    MOV  DI, OFFSET OPCAO
    MOV  DX, TAMANHO + 1  
    CALL GET_STRING           
    CMP  OPCAO, "1"
    JE   IMPRIMIR_CACA_PALAVRAS
    CMP  OPCAO, "2"
    JE   PROCURA_ESQUERDA_DIREITA
    CMP  OPCAO, "3"
    JE   PROCURA_DIREITA_ESQUERDA
    CMP  OPCAO, "4"
    JE   PROCURA_CIMA_BAIXO
    CMP  OPCAO, "5"
    JE   PROCURA_BAIXO_CIMA 
    CMP  OPCAO, "6"
    JE   PROCURA_ESQUERDA_CIMA_DIAGONAL
    CMP  OPCAO, "7"
    JE   PROCURA_DIREITA_CIMA_DIAGONAL
    CMP  OPCAO, "8"
    JE   PROCURA_ESQUERDA_BAIXO_DIAGONAL
    CMP  OPCAO, "9"
    JE   PROCURA_DIREITA_BAIXO_DIAGONAL
    CMP  OPCAO, "11"
    JE   INICIO
    CALL CLEAR_SCREEN
    JMP  FINALIZAR_PROGRAMA   
                                                   
;VARIAVEIS DE ESCOLHA DA INTERFACE      
ESCOLHA DW "OPCAO: " ,0    
OPCAO DW TAMANHO DUP(" ") ,0
OPCAO1 DW  "1-  CACA PALAVRAS" ,0
OPCAO2 DW  "2-  ESQUERDA PARA DIREITA" ,0
OPCAO3 DW  "3-  DIREITA PARA ESQUERDA" ,0 
OPCAO4 DW  "4-  CIMA PARA BAIXO" ,0
OPCAO5 DW  "5-  BAIXO PARA CIMA" ,0  
OPCAO6 DW  "6-  DIREITA CIMA DIAGONAL" ,0
OPCAO7 DW  "7-  ESQUERDA CIMA DIAGONAL" ,0
OPCAO8 DW  "8-  ESQUERDA BAIXO DIAGONAL" ,0
OPCAO9 DW  "9-  DIREITA BAIXO DIAGONAL" ,0
OPCAO10 DW "11- PROCURAR POR OUTRA PALAVRA" ,0
OPCAO0 DW  "FIM (ENTER)" ,0
;FIM DA INTERFACE        
                 
                 
;INICIO CONTAR QUANTIDADE DE LETRAS DA PALAVRA A SER LOCALIZADA
CONTAR_PALAVRA_ENTRADA:
    PUSHF
    PUSH DX
    PUSH CX
    MOV CX, 0000
    MOV SI, OFFSET PALAVRA
CONTANDO:
    MOV DL, [SI]
    CMP DL, 0
    JE RETORNA
    INC SI 
    INC CL
    JMP CONTANDO 
RETORNA:
    MOV QUANTIDADE_DE_LETRAS_PALAVRA, CL
    POP CX
    POP DX 
    POPF
    RET
;FIM CONTAR QUANTIDADE DE LETRAS DA PALAVRA A SER LOCALIZADA
   
   
;INICIO IMPRIMIR CACA PALAVRAS (ESCOLHA)
IMPRIMIR_CACA_PALAVRAS:
    POP DX
    POP DI
    POP SI
    PUSHF
    PUSH DX 
    CALL CLEAR_SCREEN 
    MOV  SI, OFFSET CACA_PALAVRAS
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_CACA_PALAVRAS:
    MOV DH, [DI]       
    CMP DH, "@"
    JE  PROXIMA_LINHA_CACA_PALAVRAS
    CMP DH, "*"
    JE  FIM_IMPRIMIR_CACA_PALAVRAS
    CALL IMPRIMIR_LETRA
    INC DI
    JMP IMPRIMINDO_CACA_PALAVRAS
PROXIMA_LINHA_CACA_PALAVRAS:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_CACA_PALAVRAS
FIM_IMPRIMIR_CACA_PALAVRAS:
    POPF
    POP DX
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INTERFACE
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    CALL CLEAR_SCREEN
    JMP INTERFACE     
;FIM IMPRIMIR CACA PALAVRAS (ESCOLHA)                             
    
                             
;INICIO ESQUERDA PARA DIREITA
PROCURA_ESQUERDA_DIREITA:
    PUSHF  
    PUSH DX
    PUSH CX
    CALL CLEAR_SCREEN
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_A
    INC DI
PROCURANDO_ESQUERDA_DIREITA_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA
    CMP DH, "*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA
    CMP DH,DL
    JE  ESQUERDA_DIREITA_BACKUP
    INC PRIMEIRA_LETRA
    MOV SI, OFFSET PALAVRA
    INC DI
    JMP PROCURANDO_ESQUERDA_DIREITA_M
PROCURANDO_ESQUERDA_DIREITA_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]  
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA
    CMP DH, "#"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_ESQUERDA_DIREITA_IGUAIS
    MOV SI, OFFSET PALAVRA
    MOV DI, CX
    INC DI
    JMP PROCURANDO_ESQUERDA_DIREITA_M
IGUAL_PARCIAL_PROCURANDO_ESQUERDA_DIREITA_IGUAIS:
    INC SI
    INC DI
    JMP PROCURANDO_ESQUERDA_DIREITA_PALAVRA
ESQUERDA_DIREITA_BACKUP:
    MOV CX, DI   
    INC PRIMEIRA_LETRA
    JMP  PROCURANDO_ESQUERDA_DIREITA_PALAVRA
ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA: 
    MOV  SI, OFFSET CACA_PALAVRAS
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_CACA_PALAVRAS_ESQUERDA_DIREITA:
    MOV COR, 7
    MOV DH, [DI]
    INC LETRA_ATUAL       
    CMP DH, "@"
    JE  PROXIMA_LINHA_ESQUERDA_DIREITA
    CMP DH, "*"
    JE  FIM_PROCURA_ESQUERDA_DIREITA
    MOV SI, [PRIMEIRA_LETRA] 
    MOV CH, [QUANTIDADE_DE_LETRAS_PALAVRA]
    CMP [LETRA_ATUAL], SI
    JE  ESQUERDA_DIREITA_IMPRIMIR_PALAVRA
    CALL IMPRIMIR_LETRA
    INC DI 
    JMP IMPRIMINDO_CACA_PALAVRAS_ESQUERDA_DIREITA
ESQUERDA_DIREITA_IMPRIMIR_PALAVRA:
    MOV DH, [DI]
    MOV COR, 2 
    CMP CH, 0
    JE  IMPRIMINDO_CACA_PALAVRAS_ESQUERDA_DIREITA
    CALL IMPRIMIR_LETRA
    INC DI
    DEC CH 
    JMP ESQUERDA_DIREITA_IMPRIMIR_PALAVRA 
PROXIMA_LINHA_ESQUERDA_DIREITA:
    ADD DI, 2 
    INC LETRA_ATUAL
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_CACA_PALAVRAS_ESQUERDA_DIREITA
NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA:
    MOV PRIMEIRA_LETRA, 0000
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX
    POPF
    MOV COR, 12    
    MOV SI, OFFSET NAO_ACHOU 
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
    PUSHF
    PUSH DX
    JMP IMPRIMINDO_CACA_PALAVRAS
FIM_PROCURA_ESQUERDA_DIREITA: 
    MOV PRIMEIRA_LETRA, 0000 
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX 
    POPF
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INTERFACE
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    CALL CLEAR_SCREEN
    JMP INTERFACE 
;FIM ESQUERDA PARA DIREITA


;INICIO DIREITA PARA ESQUERDA
PROCURA_DIREITA_ESQUERDA:
    PUSHF 
    PUSH DX
    PUSH CX
    CALL CLEAR_SCREEN
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_B 
    ADD DI,40 
PROCURANDO_DIREITA_ESQUERDA_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA_AJUSTAR
    CMP DH, "!"
    JE  PULAR_LINHA_DIREITA_ESQUERDA
    CMP DH, "$"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA 
    CMP DH,DL
    JE  DIREITA_ESQUERDA_BACKUP
    MOV SI, OFFSET PALAVRA 
    INC PRIMEIRA_LETRA
    DEC DI
    JMP PROCURANDO_DIREITA_ESQUERDA_M
PROCURANDO_DIREITA_ESQUERDA_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA_AJUSTAR
    CMP DH, "$"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA 
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_DIREITA_ESQUERDA_IGUAIS
    MOV SI, OFFSET PALAVRA
    MOV DI, CX
    DEC DI
    CALL DECREMENTAR_PRIMEIRA_LETRA_DIREITA_ESQUERDA
    INC PRIMEIRA_LETRA 
    JMP PROCURANDO_DIREITA_ESQUERDA_M
IGUAL_PARCIAL_PROCURANDO_DIREITA_ESQUERDA_IGUAIS:
    INC SI
    DEC DI
    INC PRIMEIRA_LETRA 
    INC DEC_PRIMEIRA_LETRA
    JMP PROCURANDO_DIREITA_ESQUERDA_PALAVRA
DIREITA_ESQUERDA_BACKUP:
    MOV CX, DI
    JMP PROCURANDO_DIREITA_ESQUERDA_PALAVRA
PULAR_LINHA_DIREITA_ESQUERDA:
    SUB DI, 2
    JMP PROCURANDO_DIREITA_ESQUERDA_M
DECREMENTAR_PRIMEIRA_LETRA_DIREITA_ESQUERDA:
    DEC PRIMEIRA_LETRA                                  
    DEC DEC_PRIMEIRA_LETRA
    CMP DEC_PRIMEIRA_LETRA, 0
    JE  SAIR_DECREMENTAR_PRIMEIRA_LETRA_DIREITA_ESQUERDA
    JMP DECREMENTAR_PRIMEIRA_LETRA_DIREITA_ESQUERDA
SAIR_DECREMENTAR_PRIMEIRA_LETRA_DIREITA_ESQUERDA:
    RET
ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA_AJUSTAR:
    PUSH CX
    MOV CX, 400
    SUB CX, [PRIMEIRA_LETRA]
    MOV PRIMEIRA_LETRA, CX
    POP CX
ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA:    
    MOV  SI, OFFSET CACA_PALAVRAS
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_CACA_PALAVRAS_DIREITA_ESQUERDA:
    MOV COR, 7
    MOV DH, [DI]      
    CMP DH, "@"
    JE  PROXIMA_LINHA_DIREITA_ESQUERDA 
    CMP DH, "*"
    JE  FIM_PROCURA_DIREITA_ESQUERDA
    MOV SI, [PRIMEIRA_LETRA] 
    MOV CH, [QUANTIDADE_DE_LETRAS_PALAVRA]
    CMP [LETRA_ATUAL], SI
    JE  DIREITA_ESQUERDA_IMPRIMIR_PALAVRA
    CALL IMPRIMIR_LETRA
    INC LETRA_ATUAL
    INC DI 
    JMP IMPRIMINDO_CACA_PALAVRAS_DIREITA_ESQUERDA
DIREITA_ESQUERDA_IMPRIMIR_PALAVRA:
    MOV DH, [DI]
    MOV COR, 2 
    CMP CH, 0
    JE  IMPRIMINDO_CACA_PALAVRAS_DIREITA_ESQUERDA
    CALL IMPRIMIR_LETRA
    INC LETRA_ATUAL
    INC DI
    DEC CH 
    JMP DIREITA_ESQUERDA_IMPRIMIR_PALAVRA 
PROXIMA_LINHA_DIREITA_ESQUERDA:
    ADD DI, 2 
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_CACA_PALAVRAS_DIREITA_ESQUERDA
NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA:
    MOV PRIMEIRA_LETRA, 0000
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX
    POPF
    MOV COR, 12    
    MOV SI, OFFSET NAO_ACHOU 
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
    PUSHF
    PUSH DX
    JMP IMPRIMINDO_CACA_PALAVRAS
FIM_PROCURA_DIREITA_ESQUERDA: 
    MOV PRIMEIRA_LETRA, 0000 
    MOV LETRA_ATUAL, 0000
    MOV DEC_PRIMEIRA_LETRA, 0000
    POP CX
    POP DX 
    POPF
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INTERFACE
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    CALL CLEAR_SCREEN
    JMP INTERFACE  
;FIM DIREITA PARA ESQUERDA
              

;INICIO CIMA PARA BAIXO
PROCURA_CIMA_BAIXO:
    PUSHF  
    PUSH DX                 
    PUSH CX
    CALL CLEAR_SCREEN
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_A
    INC DI 
PROCURANDO_CIMA_BAIXO_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_CIMA_BAIXO
    CMP DH, "*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_CIMA_BAIXO
    CMP DH,DL
    JE  CIMA_BAIXO_BACKUP
    CMP DH, "@"
    JE  PROXIMA_COLUNA_CIMA_BAIXO
    INC PRIMEIRA_LETRA
    MOV SI, OFFSET PALAVRA
    INC DI
    JMP PROCURANDO_CIMA_BAIXO_M 
PROCURANDO_CIMA_BAIXO_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_CIMA_BAIXO
    CMP DH, DL
    JE  IGUAL_PARCIAL_PROCURANDO_CIMA_BAIXO_IGUAIS
    MOV SI, OFFSET PALAVRA
    MOV DI, CX
    INC DI
    JMP PROCURANDO_CIMA_BAIXO_M
PROXIMA_COLUNA_CIMA_BAIXO:
    ADD DI, 2
    MOV SI, OFFSET PALAVRA
    JMP PROCURANDO_CIMA_BAIXO_M
IGUAL_PARCIAL_PROCURANDO_CIMA_BAIXO_IGUAIS:
    INC SI
    ADD DI, 42
    JMP PROCURANDO_CIMA_BAIXO_PALAVRA
CIMA_BAIXO_BACKUP:
    MOV CX, DI                                                          
    INC PRIMEIRA_LETRA
    JMP PROCURANDO_CIMA_BAIXO_PALAVRA
ACHOU_SUBSTRING_PROCURA_CIMA_BAIXO:    
    MOV  SI, OFFSET CACA_PALAVRAS
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_CIMA_BAIXO_CACA_PALAVRAS:
    MOV COR, 7
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_CIMA_BAIXO_CACA_PALAVRAS
    CMP DH, "*"
    JE  FIM_PROCURA_CIMA_BAIXO
    INC LETRA_ATUAL
    MOV CH, [QUANTIDADE_DE_LETRAS_PALAVRA] 
    MOV SI, [PRIMEIRA_LETRA]
    CMP [LETRA_ATUAL], SI
    JE  IMPRIMIR_PALAVRA_CIMA_BAIXO 
    CALL IMPRIMIR_LETRA
    INC DI   
    JMP IMPRIMINDO_CIMA_BAIXO_CACA_PALAVRAS
IMPRIMIR_PALAVRA_CIMA_BAIXO:
    MOV DH, [DI]
    MOV COR, 2
    CALL IMPRIMIR_LETRA
    INC DI                                 
    DEC CH 
    CMP CH, 0
    JE  IMPRIMINDO_CIMA_BAIXO_CACA_PALAVRAS 
    MOV COMPARADOR, 0000
IMPRIMINDO_CIMA_BAIXO_PALAVRA:
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_CIMA_BAIXO_PALAVRA
    MOV COR, 7
    CMP [COMPARADOR], 39
    JE  IMPRIMIR_PALAVRA_CIMA_BAIXO 
    CALL IMPRIMIR_LETRA
    INC COMPARADOR
    INC DI
    JMP IMPRIMINDO_CIMA_BAIXO_PALAVRA 
PULA_LINHA_CIMA_BAIXO_PALAVRA:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_CIMA_BAIXO_PALAVRA   
PULA_LINHA_CIMA_BAIXO_CACA_PALAVRAS:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_CIMA_BAIXO_CACA_PALAVRAS
NAO_ACHOU_SUBSTRING_PROCURA_CIMA_BAIXO:
    MOV PRIMEIRA_LETRA, 0000
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX
    POPF
    MOV COR, 12    
    MOV SI, OFFSET NAO_ACHOU 
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
    PUSHF
    PUSH DX
    JMP IMPRIMINDO_CACA_PALAVRAS
FIM_PROCURA_CIMA_BAIXO:
    MOV PRIMEIRA_LETRA, 0000 
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX 
    POPF
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INTERFACE
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    CALL CLEAR_SCREEN
    JMP INTERFACE
;FIM IMPRIMIR DE CIMA PARA BAIXO    
 
 
;INCIO IMPRIMIR DE BAIXO PARA CIMA
PROCURA_BAIXO_CIMA:
    PUSHF  
    PUSH DX                
    PUSH CX
    CALL CLEAR_SCREEN
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_B
    ADD DI, 40
PROCURANDO_BAIXO_CIMA_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA_AJUSTAR
    CMP DH, "$"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA
    CMP DH,DL
    JE  BAIXO_CIMA_BACKUP
    CMP DH, "!"
    JE  PROXIMA_LINHA_BAIXO_CIMA
    MOV SI, OFFSET PALAVRA
    INC PRIMEIRA_LETRA
    DEC DI
    JMP PROCURANDO_BAIXO_CIMA_M
PROCURANDO_BAIXO_CIMA_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA_AJUSTAR
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_BAIXO_CIMA_IGUAIS
    MOV SI, OFFSET PALAVRA       
    MOV DI, CX
    DEC DI
    INC PRIMEIRA_LETRA
    CALL DECREMENTAR_PRIMEIRA_LETRA_BAIXO_CIMA
    JMP PROCURANDO_BAIXO_CIMA_M 
PROXIMA_LINHA_BAIXO_CIMA:
    SUB DI, 2
    MOV SI, OFFSET PALAVRA
    JMP PROCURANDO_BAIXO_CIMA_M
IGUAL_PARCIAL_PROCURANDO_BAIXO_CIMA_IGUAIS:
    INC SI
    ADD PRIMEIRA_LETRA,40
    INC DEC_PRIMEIRA_LETRA
    SUB DI, 42
    JMP PROCURANDO_BAIXO_CIMA_PALAVRA
BAIXO_CIMA_BACKUP:
    MOV CX, DI
    JMP PROCURANDO_BAIXO_CIMA_PALAVRA 
DECREMENTAR_PRIMEIRA_LETRA_BAIXO_CIMA:
    SUB PRIMEIRA_LETRA, 40 
    DEC DEC_PRIMEIRA_LETRA
    CMP DEC_PRIMEIRA_LETRA, 0
    JE  SAIR_DECREMENTAR_PRIMEIRA_LETRA_BAIXO_CIMA
    JMP DECREMENTAR_PRIMEIRA_LETRA_BAIXO_CIMA
SAIR_DECREMENTAR_PRIMEIRA_LETRA_BAIXO_CIMA:
    RET
ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA_AJUSTAR:
    PUSH CX
    MOV CX, 440
    SUB CX, [PRIMEIRA_LETRA]
    MOV PRIMEIRA_LETRA, CX
    POP CX
ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA:
    MOV  SI, OFFSET CACA_PALAVRAS
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_BAIXO_CIMA_CACA_PALAVRAS:
    MOV COR, 7
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_BAIXO_CIMA_CACA_PALAVRAS
    CMP DH, "*"
    JE  FIM_PROCURA_BAIXO_CIMA
    INC LETRA_ATUAL
    MOV CH, [QUANTIDADE_DE_LETRAS_PALAVRA] 
    MOV SI, [PRIMEIRA_LETRA]
    CMP [LETRA_ATUAL], SI
    JE  IMPRIMIR_PALAVRA_BAIXO_CIMA 
    CALL IMPRIMIR_LETRA
    INC DI   
    JMP IMPRIMINDO_BAIXO_CIMA_CACA_PALAVRAS
IMPRIMIR_PALAVRA_BAIXO_CIMA:
    MOV DH, [DI]
    MOV COR, 2
    CALL IMPRIMIR_LETRA
    INC DI                                 
    DEC CH 
    CMP CH, 0
    JE  IMPRIMINDO_BAIXO_CIMA_CACA_PALAVRAS 
    MOV COMPARADOR, 0000
IMPRIMINDO_BAIXO_CIMA_PALAVRA:
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_BAIXO_CIMA_PALAVRA
    MOV COR, 7
    CMP [COMPARADOR], 39
    JE  IMPRIMIR_PALAVRA_BAIXO_CIMA 
    CALL IMPRIMIR_LETRA
    INC COMPARADOR
    INC DI
    JMP IMPRIMINDO_BAIXO_CIMA_PALAVRA 
PULA_LINHA_BAIXO_CIMA_PALAVRA:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_BAIXO_CIMA_PALAVRA   
PULA_LINHA_BAIXO_CIMA_CACA_PALAVRAS:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_BAIXO_CIMA_CACA_PALAVRAS
NAO_ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA:
    MOV PRIMEIRA_LETRA, 0000
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX
    POPF
    MOV COR, 12    
    MOV SI, OFFSET NAO_ACHOU 
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
    PUSHF
    PUSH DX
    JMP IMPRIMINDO_CACA_PALAVRAS
FIM_PROCURA_BAIXO_CIMA:
    MOV PRIMEIRA_LETRA, 0000 
    MOV LETRA_ATUAL, 0000
    MOV DEC_PRIMEIRA_LETRA, 0000
    POP CX
    POP DX 
    POPF
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INTERFACE
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    CALL CLEAR_SCREEN
    JMP INTERFACE
;FIM IMPRIMIR DE BAIXO PARA CIMA


;INICIO IMPRIMIR DIAGONAL ESQUERDA PARA DIREITA DE CIMA PARA BAIXO
PROCURA_ESQUERDA_CIMA_DIAGONAL:
    PUSHF  
    PUSH DX
    PUSH CX
    CALL CLEAR_SCREEN
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_A
    INC DI             
    JMP PROCURANDO_ESQUERDA_CIMA_DIAGONAL_M
PROXIMA_LINHA_ESQUERDA_CIMA_DIAGONAL:
    ADD DI, 2                           
    CMP DI,"*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL
    MOV SI, OFFSET PALAVRA  
    JMP PROCURANDO_ESQUERDA_CIMA_DIAGONAL_M
ESQUERDA_CIMA_DIAGONAL_BACKUP:
    MOV CX, DI
    INC PRIMEIRA_LETRA
    JMP PROCURA_PALAVRA_ESQUERDA_CIMA_DIAGONAL
PROCURANDO_ESQUERDA_CIMA_DIAGONAL_M:
    MOV DL, [SI] 
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL
    CMP DI, "@"
    JE  PROXIMA_LINHA_ESQUERDA_CIMA_DIAGONAL
    CMP DH, "*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL
    CMP DH,DL
    JE  ESQUERDA_CIMA_DIAGONAL_BACKUP
    INC DI
    INC PRIMEIRA_LETRA
    MOV SI, OFFSET PALAVRA
    JMP PROCURANDO_ESQUERDA_CIMA_DIAGONAL_M 
PROCURA_PALAVRA_ESQUERDA_CIMA_DIAGONAL:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL
    CMP DI, "@"
    JE  PROXIMA_LINHA_ESQUERDA_CIMA_DIAGONAL  
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_ESQUERDA_CIMA_DIAGONAL_IGUAIS
    MOV DI, CX
    INC DI
    MOV SI, OFFSET PALAVRA 
    JMP PROCURANDO_ESQUERDA_CIMA_DIAGONAL_M
IGUAL_PARCIAL_PROCURANDO_ESQUERDA_CIMA_DIAGONAL_IGUAIS:
    INC SI
    ADD DI, 43
    JMP PROCURA_PALAVRA_ESQUERDA_CIMA_DIAGONAL
ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL:
    MOV  SI, OFFSET CACA_PALAVRAS
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_ESQUERDA_CIMA_DIAGONAL_CACA_PALAVRAS:
    MOV COR, 7
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_ESQUERDA_CIMA_DIAGONAL_CACA_PALAVRAS
    CMP DH, "*"
    JE  FIM_PROCURA_ESQUERDA_CIMA_DIAGONAL
    INC LETRA_ATUAL
    MOV CH, [QUANTIDADE_DE_LETRAS_PALAVRA] 
    MOV SI, [PRIMEIRA_LETRA]
    CMP [LETRA_ATUAL], SI
    JE  IMPRIMIR_PALAVRA_ESQUERDA_CIMA_DIAGONAL 
    CALL IMPRIMIR_LETRA
    INC DI   
    JMP IMPRIMINDO_ESQUERDA_CIMA_DIAGONAL_CACA_PALAVRAS
IMPRIMIR_PALAVRA_ESQUERDA_CIMA_DIAGONAL:
    MOV DH, [DI]
    MOV COR, 2
    CALL IMPRIMIR_LETRA
    INC DI                                 
    DEC CH 
    CMP CH, 0
    JE  IMPRIMINDO_ESQUERDA_CIMA_DIAGONAL_CACA_PALAVRAS 
    MOV COMPARADOR, 0000
IMPRIMINDO_ESQUERDA_CIMA_DIAGONAL_PALAVRA:
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_ESQUERDA_CIMA_DIAGONAL_PALAVRA
    MOV COR, 7
    CMP [COMPARADOR], 40
    JE  IMPRIMIR_PALAVRA_ESQUERDA_CIMA_DIAGONAL 
    CALL IMPRIMIR_LETRA
    INC COMPARADOR
    INC DI
    JMP IMPRIMINDO_ESQUERDA_CIMA_DIAGONAL_PALAVRA 
PULA_LINHA_ESQUERDA_CIMA_DIAGONAL_PALAVRA:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_ESQUERDA_CIMA_DIAGONAL_PALAVRA   
PULA_LINHA_ESQUERDA_CIMA_DIAGONAL_CACA_PALAVRAS:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_ESQUERDA_CIMA_DIAGONAL_CACA_PALAVRAS
NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL:
    MOV PRIMEIRA_LETRA, 0000
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX
    POPF
    MOV COR, 12    
    MOV SI, OFFSET NAO_ACHOU 
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
    PUSHF
    PUSH DX
    JMP IMPRIMINDO_CACA_PALAVRAS
FIM_PROCURA_ESQUERDA_CIMA_DIAGONAL:                           
    MOV PRIMEIRA_LETRA, 0000 
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX 
    POPF
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INTERFACE
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    CALL CLEAR_SCREEN
    JMP INTERFACE
;FIM IMPRIMIR DIAGONAL ESQUERDA PARA DIREITA DE CIMA PARA BAIXO   


;INICIO IMPRIMIR DIAGONAL DIREITA PARA ESQUERDA DE CIMA PARA BAIXO
PROCURA_DIREITA_CIMA_DIAGONAL:
    PUSHF  
    PUSH DX
    PUSH CX
    CALL CLEAR_SCREEN
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_A
    INC DI            
    JMP PROCURANDO_DIREITA_CIMA_DIAGONAL_M
PROXIMA_LINHA_DIREITA_CIMA_DIAGONAL:
    INC DI                           
    CMP DI, "*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL
    MOV SI, OFFSET PALAVRA
    JMP PROCURANDO_DIREITA_CIMA_DIAGONAL_M
DIREITA_CIMA_DIAGONAL_BACKUP:
    MOV CX, DI
    INC PRIMEIRA_LETRA 
    JMP PROCURA_PALAVRA_DIREITA_CIMA_DIAGONAL
PROCURANDO_DIREITA_CIMA_DIAGONAL_M:
    MOV DL, [SI] 
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL
    CMP DH, "@"
    JE  PROXIMA_LINHA_DIREITA_CIMA_DIAGONAL
    CMP DH, "*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL
    CMP DH,DL
    JE  DIREITA_CIMA_DIAGONAL_BACKUP
    INC DI
    INC PRIMEIRA_LETRA
    MOV SI, OFFSET PALAVRA
    JMP PROCURANDO_DIREITA_CIMA_DIAGONAL_M 
PROCURA_PALAVRA_DIREITA_CIMA_DIAGONAL:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL  
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_DIREITA_CIMA_DIAGONAL_IGUAIS
    MOV DI, CX
    INC DI
    MOV SI, OFFSET PALAVRA  
    JMP PROCURANDO_DIREITA_CIMA_DIAGONAL_M
IGUAL_PARCIAL_PROCURANDO_DIREITA_CIMA_DIAGONAL_IGUAIS:
    INC SI
    ADD DI, 41
    JMP PROCURA_PALAVRA_DIREITA_CIMA_DIAGONAL
ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL:
    MOV  SI, OFFSET CACA_PALAVRAS
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_DIREITA_CIMA_DIAGONAL_CACA_PALAVRAS:
    MOV COR, 7
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_DIREITA_CIMA_DIAGONAL_CACA_PALAVRAS
    CMP DH, "*"
    JE  FIM_PROCURA_DIREITA_CIMA_DIAGONAL
    INC LETRA_ATUAL
    MOV CH, [QUANTIDADE_DE_LETRAS_PALAVRA] 
    MOV SI, [PRIMEIRA_LETRA]
    CMP [LETRA_ATUAL], SI
    JE  IMPRIMIR_PALAVRA_DIREITA_CIMA_DIAGONAL 
    CALL IMPRIMIR_LETRA
    INC DI   
    JMP IMPRIMINDO_DIREITA_CIMA_DIAGONAL_CACA_PALAVRAS
IMPRIMIR_PALAVRA_DIREITA_CIMA_DIAGONAL:
    MOV DH, [DI]
    MOV COR, 2
    CALL IMPRIMIR_LETRA
    INC DI                                 
    DEC CH 
    CMP CH, 0
    JE  IMPRIMINDO_DIREITA_CIMA_DIAGONAL_CACA_PALAVRAS 
    MOV COMPARADOR, 0000
IMPRIMINDO_DIREITA_CIMA_DIAGONAL_PALAVRA:
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_DIREITA_CIMA_DIAGONAL_PALAVRA
    MOV COR, 7
    CMP [COMPARADOR], 38
    JE  IMPRIMIR_PALAVRA_DIREITA_CIMA_DIAGONAL 
    CALL IMPRIMIR_LETRA
    INC COMPARADOR
    INC DI
    JMP IMPRIMINDO_DIREITA_CIMA_DIAGONAL_PALAVRA 
PULA_LINHA_DIREITA_CIMA_DIAGONAL_PALAVRA:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_DIREITA_CIMA_DIAGONAL_PALAVRA   
PULA_LINHA_DIREITA_CIMA_DIAGONAL_CACA_PALAVRAS:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_DIREITA_CIMA_DIAGONAL_CACA_PALAVRAS
NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL:
    MOV PRIMEIRA_LETRA, 0000
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX
    POPF
    MOV COR, 12    
    MOV SI, OFFSET NAO_ACHOU 
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
    PUSHF
    PUSH DX
    JMP IMPRIMINDO_CACA_PALAVRAS
FIM_PROCURA_DIREITA_CIMA_DIAGONAL:
    MOV PRIMEIRA_LETRA, 0000 
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX 
    POPF
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INTERFACE
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    CALL CLEAR_SCREEN
    JMP INTERFACE
;FIM IMPRIMIR DIAGONAL DIREITA PARA ESQUERDA DE CIMA PARA BAIXO
                                                               

;INICIO IMPRIMIR DIAGONAL ESQUERDA PARA DIREITA DE BAIXO PARA CIMA
PROCURA_ESQUERDA_BAIXO_DIAGONAL:
    PUSHF 
    PUSH DX   
    PUSH CX
    CALL CLEAR_SCREEN 
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_B
    ADD DI, 40
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_M
ESQUERDA_BAIXO_DIAGONAL_PUSH:
    MOV CX, DI
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_PALAVRA 
PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL_AJUSTAR 
    CMP DH, "$"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL
    CMP DH,DL
    JE  ESQUERDA_BAIXO_DIAGONAL_PUSH 
    CMP DH, "!"
    JE  PROXIMA_LINHA_ESQUERDA_BAIXO_DIAGONAL
    MOV SI, OFFSET PALAVRA
    DEC DI 
    INC PRIMEIRA_LETRA
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_M
PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL_AJUSTAR 
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_IGUAIS
    MOV SI, OFFSET PALAVRA
    MOV DI, CX
    DEC DI
    CALL DECREMENTAR_PRIMEIRA_LETRA_ESQUERDA_BAIXO_DIAGONAL
    INC PRIMEIRA_LETRA
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_M
IGUAL_PARCIAL_PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_IGUAIS:
    INC SI 
    ADD PRIMEIRA_LETRA, 39
    INC DEC_PRIMEIRA_LETRA
    SUB DI, 41
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_PALAVRA
PROXIMA_LINHA_ESQUERDA_BAIXO_DIAGONAL:
    SUB DI, 2
    MOV SI, OFFSET PALAVRA
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_M  
DECREMENTAR_PRIMEIRA_LETRA_ESQUERDA_BAIXO_DIAGONAL:
    SUB PRIMEIRA_LETRA, 39
    DEC DEC_PRIMEIRA_LETRA
    CMP DEC_PRIMEIRA_LETRA, 0
    JE  SAIR_DECREMENTAR_PRIMEIRA_LETRA_ESQUERDA_BAIXO_DIAGONAL
    JMP DECREMENTAR_PRIMEIRA_LETRA_ESQUERDA_BAIXO_DIAGONAL
SAIR_DECREMENTAR_PRIMEIRA_LETRA_ESQUERDA_BAIXO_DIAGONAL:   
    RET
ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL_AJUSTAR:
    PUSH CX
    MOV CX, 439
    SUB CX, [PRIMEIRA_LETRA]
    MOV PRIMEIRA_LETRA, CX
    POP CX
ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL:
    MOV  SI, OFFSET CACA_PALAVRAS
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_ESQUERDA_BAIXO_DIAGONAL_CACA_PALAVRAS:
    MOV COR, 7
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_ESQUERDA_BAIXO_DIAGONAL_CACA_PALAVRAS
    CMP DH, "*"
    JE  FIM_PROCURA_ESQUERDA_BAIXO_DIAGONAL
    INC LETRA_ATUAL
    MOV CH, [QUANTIDADE_DE_LETRAS_PALAVRA] 
    MOV SI, [PRIMEIRA_LETRA]
    CMP [LETRA_ATUAL], SI
    JE  IMPRIMIR_PALAVRA_ESQUERDA_BAIXO_DIAGONAL 
    CALL IMPRIMIR_LETRA
    INC DI   
    JMP IMPRIMINDO_ESQUERDA_BAIXO_DIAGONAL_CACA_PALAVRAS
IMPRIMIR_PALAVRA_ESQUERDA_BAIXO_DIAGONAL:
    MOV DH, [DI]
    MOV COR, 2
    CALL IMPRIMIR_LETRA
    INC DI                                 
    DEC CH 
    CMP CH, 0
    JE  IMPRIMINDO_ESQUERDA_BAIXO_DIAGONAL_CACA_PALAVRAS 
    MOV COMPARADOR, 0000
IMPRIMINDO_ESQUERDA_BAIXO_DIAGONAL_PALAVRA:
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_ESQUERDA_BAIXO_DIAGONAL_PALAVRA
    MOV COR, 7
    CMP [COMPARADOR], 38
    JE  IMPRIMIR_PALAVRA_ESQUERDA_BAIXO_DIAGONAL 
    CALL IMPRIMIR_LETRA
    INC COMPARADOR
    INC DI
    JMP IMPRIMINDO_ESQUERDA_BAIXO_DIAGONAL_PALAVRA 
PULA_LINHA_ESQUERDA_BAIXO_DIAGONAL_PALAVRA:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_ESQUERDA_BAIXO_DIAGONAL_PALAVRA   
PULA_LINHA_ESQUERDA_BAIXO_DIAGONAL_CACA_PALAVRAS:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_ESQUERDA_BAIXO_DIAGONAL_CACA_PALAVRAS
NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL:
    MOV PRIMEIRA_LETRA, 0000
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX
    POPF
    MOV COR, 12    
    MOV SI, OFFSET NAO_ACHOU 
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
    PUSHF
    PUSH DX
    JMP IMPRIMINDO_CACA_PALAVRAS
FIM_PROCURA_ESQUERDA_BAIXO_DIAGONAL: 
    MOV PRIMEIRA_LETRA, 0000 
    MOV LETRA_ATUAL, 0000  
    MOV DEC_PRIMEIRA_LETRA, 0000
    POP CX
    POP DX 
    POPF
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INTERFACE
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    CALL CLEAR_SCREEN
    JMP INTERFACE 
;FIM IMPRIMIR DIAGONAL ESQUERDA PARA DIREITA DE BAIXO PARA CIMA


;INICIO IMPRIMIR DIAGONAL DIREITA PARA ESQUERDA DE BAIXO PARA CIMA
PROCURA_DIREITA_BAIXO_DIAGONAL:
    PUSHF 
    PUSH DX
    PUSH CX   
    CALL CLEAR_SCREEN
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_B
    ADD DI, 40 
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_M
DIREITA_BAIXO_DIAGONAL_BACKUP:
    MOV CX, DI
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_PALAVRA 
PROCURANDO_DIREITA_BAIXO_DIAGONAL_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL_AJUSTES 
    CMP DH, "$"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL
    CMP DH, "!"
    JE  PROXIMA_LINHA_DIREITA_BAIXO_DIAGONAL
    CMP DH,DL
    JE  DIREITA_BAIXO_DIAGONAL_BACKUP
    MOV SI, OFFSET PALAVRA
    DEC DI
    INC PRIMEIRA_LETRA
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_M
PROCURANDO_DIREITA_BAIXO_DIAGONAL_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL_AJUSTES 
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_DIREITA_BAIXO_DIAGONAL_IGUAIS
    MOV SI, OFFSET PALAVRA
    MOV DI, CX
    DEC DI
    CALL DECREMENTA_PRIMEIRA_LETRA_DIREITA_BAIXO_DIAGONAL
    INC PRIMEIRA_LETRA
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_M
IGUAL_PARCIAL_PROCURANDO_DIREITA_BAIXO_DIAGONAL_IGUAIS:
    INC SI
    ADD PRIMEIRA_LETRA, 41
    INC DEC_PRIMEIRA_LETRA
    SUB DI, 43
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_PALAVRA
PROXIMA_LINHA_DIREITA_BAIXO_DIAGONAL:
    SUB DI, 2
    MOV SI, OFFSET PALAVRA
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_M 
DECREMENTA_PRIMEIRA_LETRA_DIREITA_BAIXO_DIAGONAL:
    SUB PRIMEIRA_LETRA, 41
    DEC DEC_PRIMEIRA_LETRA
    CMP DEC_PRIMEIRA_LETRA, 0
    JE  SAIR_DECREMENTA_PRIMEIRA_LETRA_DIREITA_BAIXO_DIAGONAL
    JMP DECREMENTA_PRIMEIRA_LETRA_DIREITA_BAIXO_DIAGONAL
SAIR_DECREMENTA_PRIMEIRA_LETRA_DIREITA_BAIXO_DIAGONAL:
    RET
ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL_AJUSTES:
    PUSH CX
    MOV CX, 441
    SUB CX, [PRIMEIRA_LETRA]
    MOV PRIMEIRA_LETRA, CX
    POP CX
ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL:
    MOV  SI, OFFSET CACA_PALAVRAS
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_DIREITA_BAIXO_DIAGONAL_CACA_PALAVRAS:
    MOV COR, 7
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_DIREITA_BAIXO_DIAGONAL_CACA_PALAVRAS
    CMP DH, "*"
    JE  FIM_PROCURA_DIREITA_BAIXO_DIAGONAL
    INC LETRA_ATUAL
    MOV CH, [QUANTIDADE_DE_LETRAS_PALAVRA] 
    MOV SI, [PRIMEIRA_LETRA]
    CMP [LETRA_ATUAL], SI
    JE  IMPRIMIR_PALAVRA_DIREITA_BAIXO_DIAGONAL 
    CALL IMPRIMIR_LETRA
    INC DI   
    JMP IMPRIMINDO_DIREITA_BAIXO_DIAGONAL_CACA_PALAVRAS
IMPRIMIR_PALAVRA_DIREITA_BAIXO_DIAGONAL:
    MOV DH, [DI]
    MOV COR, 2
    CALL IMPRIMIR_LETRA
    INC DI                                 
    DEC CH 
    CMP CH, 0
    JE  IMPRIMINDO_DIREITA_BAIXO_DIAGONAL_CACA_PALAVRAS 
    MOV COMPARADOR, 0000
IMPRIMINDO_DIREITA_BAIXO_DIAGONAL_PALAVRA:
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_DIREITA_BAIXO_DIAGONAL_PALAVRA
    MOV COR, 7
    CMP [COMPARADOR], 40
    JE  IMPRIMIR_PALAVRA_DIREITA_BAIXO_DIAGONAL 
    CALL IMPRIMIR_LETRA
    INC COMPARADOR
    INC DI
    JMP IMPRIMINDO_DIREITA_BAIXO_DIAGONAL_PALAVRA 
PULA_LINHA_DIREITA_BAIXO_DIAGONAL_PALAVRA:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_DIREITA_BAIXO_DIAGONAL_PALAVRA   
PULA_LINHA_DIREITA_BAIXO_DIAGONAL_CACA_PALAVRAS:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_DIREITA_BAIXO_DIAGONAL_CACA_PALAVRAS
NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL:
    MOV PRIMEIRA_LETRA, 0000
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX
    POPF
    MOV COR, 12    
    MOV SI, OFFSET NAO_ACHOU 
    CALL PRINT_STRING
    CALL PULA_LINHA
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
    PUSHF
    PUSH DX
    JMP IMPRIMINDO_CACA_PALAVRAS
FIM_PROCURA_DIREITA_BAIXO_DIAGONAL: 
    MOV PRIMEIRA_LETRA, 0000 
    MOV LETRA_ATUAL, 0000  
    MOV DEC_PRIMEIRA_LETRA, 0000
    POP CX
    POP DX 
    POPF
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INTERFACE
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    CALL CLEAR_SCREEN
    JMP INTERFACE 
;FIM IMPRIMIR DIAGONAL DIREITA PARA ESQUERDA DE BAIXO PARA CIMA

                                                               
;METODOS UNIVERSAIS

;IMPRIMIR INTERFACE
INICIO_IMPRIMIR_INTERFACE:
    PUSH DX
IMPRIMIR_INTERFACE:
    MOV DL, [SI]
    CMP DL, 0
    JE  FIM_IMPRIMIR_INTERFACE
    CALL IMPRIMIR_LETRA 
    INC SI
    JMP IMPRIMIR_INTERFACE
FIM_IMPRIMIR_INTERFACE:
    POP DX
    RET
          
          
;IMPRIMIR LETRA COLORIDA
IMPRIMIR_LETRA:
    PUSH AX
    PUSH DX
    PUSH BX
    PUSH CX
    MOV AH, 9
    MOV BH, 0
    MOV AL, DH
    MOV BL, COR
    MOV CX, 1 
    INT 10H
    POP CX
    POP BX
    POP DX
    POP AX
AVANCAR_COLUNA:
    PUSH AX
    PUSH CX 
    PUSH DX
    MOV AH, 3
    INT 10H
    MOV AH, 2 
    INC DL
    INT 10H
    POP DX
    POP CX
    POP AX 
    RET

;PULAR LINHA LETRA COLORIDA
PULA_LINHA_CACA_PALAVRAS:
    PUSHF
    PUSH AX
    PUSH CX
    PUSH DX
    MOV  AH, 3
    INT 10H
    MOV  AH, 2
    INC  DH
    MOV  DL, 0
    INT 10H 
    POP  DX
    POP  CX
    POP  AX
    POPF
    RET    
               
;PULAR LINHA    
PULA_LINHA:                      
    PUSHF
    PUSH AX
    PUSH DX
    MOV AH,2
    MOV DL,13        
    INT 21H
    MOV AH,2
    MOV DL,10
    INT 21H
    POP DX        
    POP AX
    POPF
    RET     

;FINALIZA O PROGRAMA     
FINALIZAR_PROGRAMA:                                                                             
    MOV AH,4CH
    MOV AL, 0
    INT 21H
 
 
;RESET NA TELA
CLEAR_SCREEN:
    PUSH AX
    MOV  AH, 0 
    INT  10H
    POP  AX
    RET
     
     
;VARIAVEIS AUXILIARES
PRIMEIRA_LETRA DW 0 ,0
NAO_ACHOU DB "NAO ACHOU" ,0
LETRA_ATUAL DW 0 ,0
COMPARADOR DW 0 ,0
DEC_PRIMEIRA_LETRA DW 0 ,0
 
 
;PALAVRA A BUSCAR
PALAVRA DB TAMANHO DUP(" "),0  
QUANTIDADE_DE_LETRAS_PALAVRA DB 00
 
 
;VARIAVEIS PARA INTERFACE
CACA_PALAVRAS DB "CACA PALAVRAS:",0 
ENTRE_COM_UMA_STRING DB "ENTRE COM UMA STRING: ",0
COR DB 7
VOLTAR_INTERFACE DB "VOLTAR PARA A INTERFACE" ,0 
RESPOSTA DB "" ,0


;NOME DOS ALUNOS 
ALUNO DW "ALUNOS:" ,0
ALUNO1 DW "LUIZ HENRIQUE MARTENDAL" ,0
ALUNO2 DW "GABRIEL CARDOSO DE SOUZA" ,0
ALUNO3 DW "GUSTAVO WESTPHAL ANTUNES" ,0  
                                        
                                                                         
;FIXO 10X40
         DB 0,"#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@"
INICIO_A DB   "!MEUGAMKASJDKFLJSADKLFJAKLSJDFKLASJDFKJMM@"
         DB   "!AIJDFLKASJDKFLJSADKLFJAKLSJDFKLASJDFKIII@"
         DB   "!ALGKDFJKLASDJFLKSAJDKFLJSADKLFJLKDSAGGLG@"
         DB   "!ASJUFLKASMIGUELJSADKLFJAKLSJDFKLESJUUKJU@"
         DB   "!ALLKELDFASDDJFLKSAJDKFLJSADKLFJLKUEEJFLE@"
         DB   "!ASEDELKASJDKFLJSADKLFJAKLSJDFKLASLGGKJSL@"
         DB   "!ALUUDFJKLASDJFLKSAJDKFLJSADKLFJLKDSIJFLK@"
         DB   "!ASGDFLKASJDKFLJSADKLFJAKLSJDFKLASJDEMJSA@"
         DB   "!AIIKDFJKLASDJFLKSAJDKFLJSALEUGIMKDSLJFLK@"
INICIO_B DB   "!MSMMFLKASJDKFLJSADKLFJAKLSJDFKLASJDFKJSA@"
         DB   "*****************************************#",0