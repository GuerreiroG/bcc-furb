INCLUDE "emu8086.inc"

TAMANHO EQU 32

org 100h

DEFINE_GET_STRING
DEFINE_PRINT_STRING

    MOV DI, OFFSET PALAVRA
    MOV DX, TAMANHO + 1
    CALL GET_STRING
                                             
    ;CALL PULA_LINHA                                  
    ;CALL PROCURA_ESQUERDA_DIREITA 
    
    ;CALL PULA_LINHA
    ;CALL PROCURA_DIREITA_ESQUERDA
    
    ;CALL PULA_LINHA
    ;CALL PROCURA_CIMA_BAIXO
    
    ;CALL PULA_LINHA
    ;CALL PROCURA_BAIXO_CIMA
    
    CALL PULA_LINHA
    CALL PROCURA_ESQUERDA_CIMA_DIAGONAL
    
    ;CALL PULA_LINHA
    ;CALL PROCURA_DIREITA_CIMA_DIAGONAL 
    
    ;CALL PULA_LINHA
    ;CALL PROCURA_DIREITA_BAIXO_DIAGONAL
    
    ;CALL PULA_LINHA
    ;CALL PROCURA_ESQUERDA_BAIXO_DIAGONAL
    
    MOV AH,4CH
    MOV AL, 0
    INT 21H                                            


PROCURA_ESQUERDA_DIREITA:
    PUSHF  
    PUSH DX
    PUSH CX
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_A
PROCURANDO_ESQUERDA_DIREITA_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA
    CMP DH, "#"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA
    CMP DH,DL
    JE  ESQUERDA_DIREITA_BACKUP
    MOV SI, OFFSET PALAVRA
    INC DI
    JMP PROCURANDO_ESQUERDA_DIREITA_M
PROCURANDO_ESQUERDA_DIREITA_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]  
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA
    CMP DH, "#"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_ESQUERDA_DIREITA_IGUAIS
    MOV SI, OFFSET PALAVRA
    MOV DI, CX
    INC DI
    JMP PROCURANDO_ESQUERDA_DIREITA_M
IGUAL_PARCIAL_PROCURANDO_ESQUERDA_DIREITA_IGUAIS:
    INC SI
    INC DI
    JMP PROCURANDO_ESQUERDA_DIREITA_PALAVRA
ESQUERDA_DIREITA_BACKUP:
    MOV CX, DI
    JMP  PROCURANDO_ESQUERDA_DIREITA_PALAVRA
ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA:
    MOV AH,2
    MOV DL,"S"
    INT 21H
    JMP FIM_PROCURA_ESQUERDA_DIREITA
NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA:
    MOV AH,2
    MOV DL,"N"
    INT 21H
FIM_PROCURA_ESQUERDA_DIREITA: 
    POP CX
    POP DX 
    POPF
    RET 
   
   
PROCURA_DIREITA_ESQUERDA:
    PUSHF 
    PUSH DX
    PUSH CX
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_B 
    ADD DI,40 
PROCURANDO_DIREITA_ESQUERDA_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA
    CMP DH, "$"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA 
    CMP DH,DL
    JE  DIREITA_ESQUERDA_BACKUP
    MOV SI, OFFSET PALAVRA
    DEC DI
    JMP PROCURANDO_DIREITA_ESQUERDA_M
PROCURANDO_DIREITA_ESQUERDA_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA
    CMP DH, "$"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA 
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_DIREITA_ESQUERDA_IGUAIS
    MOV SI, OFFSET PALAVRA
    MOV DI, CX
    DEC DI
    JMP PROCURANDO_DIREITA_ESQUERDA_M
IGUAL_PARCIAL_PROCURANDO_DIREITA_ESQUERDA_IGUAIS:
    INC SI
    DEC DI
    JMP PROCURANDO_DIREITA_ESQUERDA_PALAVRA
DIREITA_ESQUERDA_BACKUP:
    MOV CX, DI
    JMP PROCURANDO_DIREITA_ESQUERDA_PALAVRA
ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA:
    MOV AH,2
    MOV DL,"S"
    INT 21H
    JMP FIM_PROCURA_DIREITA_ESQUERDA
NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA:
    MOV AH,2
    MOV DL,"N"
    INT 21H
FIM_PROCURA_DIREITA_ESQUERDA: 
    POP CX
    POP DX
    POPF
    RET 
 
    
PROCURA_CIMA_BAIXO:
    PUSHF  
    PUSH DX
    PUSH CX                 
    PUSH BX
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_A  
    INC DI
    MOV CX, DI 
PROCURANDO_CIMA_BAIXO_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_CIMA_BAIXO
    CMP DH, "*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_CIMA_BAIXO
    CMP DH,DL
    JE  CIMA_BAIXO_BACKUP
    CMP DH, "@"
    JE  PROXIMA_COLUNA_CIMA_BAIXO
    MOV SI, OFFSET PALAVRA
    INC DI
    JMP PROCURANDO_CIMA_BAIXO_M 
PROCURANDO_CIMA_BAIXO_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_CIMA_BAIXO
    CMP DH, DL
    JE  IGUAL_PARCIAL_PROCURANDO_CIMA_BAIXO_IGUAIS
    MOV SI, OFFSET PALAVRA
    MOV DI, BX
    INC DI
    JMP PROCURANDO_CIMA_BAIXO_M
PROXIMA_COLUNA_CIMA_BAIXO:
    ADD DI, 2
    MOV SI, OFFSET PALAVRA
    JMP PROCURANDO_CIMA_BAIXO_M
IGUAL_PARCIAL_PROCURANDO_CIMA_BAIXO_IGUAIS:
    INC SI
    ADD DI, 42
    JMP PROCURANDO_CIMA_BAIXO_PALAVRA
CIMA_BAIXO_BACKUP:
    MOV BX, DI
    JMP PROCURANDO_CIMA_BAIXO_PALAVRA
ACHOU_SUBSTRING_PROCURA_CIMA_BAIXO:
    MOV AH,2
    MOV DL,"S"
    INT 21H
    JMP FIM_PROCURA_CIMA_BAIXO
NAO_ACHOU_SUBSTRING_PROCURA_CIMA_BAIXO:
    MOV AH,2
    MOV DL,"N"
    INT 21H
FIM_PROCURA_CIMA_BAIXO:
    POP BX
    POP CX
    POP DX
    POPF
    RET


PROCURA_BAIXO_CIMA:
    PUSHF  
    PUSH DX                
    PUSH CX
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_B
    ADD DI, 40
PROCURANDO_BAIXO_CIMA_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA
    CMP DH, "$"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA
    CMP DH,DL
    JE  BAIXO_CIMA_BACKUP
    CMP DH, "!"
    JE  PROXIMA_LINHA_BAIXO_CIMA
    MOV SI, OFFSET PALAVRA
    DEC DI
    JMP PROCURANDO_BAIXO_CIMA_M
PROCURANDO_BAIXO_CIMA_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_BAIXO_CIMA_IGUAIS
    MOV SI, OFFSET PALAVRA       
    MOV DI, CX
    DEC DI
    JMP PROCURANDO_BAIXO_CIMA_M 
PROXIMA_LINHA_BAIXO_CIMA:
    SUB DI, 2
    MOV SI, OFFSET PALAVRA
    JMP PROCURANDO_BAIXO_CIMA_M
IGUAL_PARCIAL_PROCURANDO_BAIXO_CIMA_IGUAIS:
    INC SI
    SUB DI, 42
    JMP PROCURANDO_BAIXO_CIMA_PALAVRA
BAIXO_CIMA_BACKUP:
    MOV CX, DI
    JMP PROCURANDO_BAIXO_CIMA_PALAVRA
ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA:
    MOV AH,2
    MOV DL,"S"
    INT 21H
    JMP FIM_PROCURA_BAIXO_CIMA
NAO_ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA:
    MOV AH,2
    MOV DL,"N"
    INT 21H
FIM_PROCURA_BAIXO_CIMA:
    POP CX
    POP DX
    POPF
    RET
    

PROCURA_ESQUERDA_CIMA_DIAGONAL:
    PUSHF  
    PUSH DX
    PUSH CX
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_A             
    JMP PROCURANDO_ESQUERDA_CIMA_DIAGONAL_M
PROXIMA_LINHA_ESQUERDA_CIMA_DIAGONAL:
    ADD DI, 2                           
    CMP DI,"*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL
    MOV SI, OFFSET PALAVRA  
    JMP PROCURANDO_ESQUERDA_CIMA_DIAGONAL_M
ESQUERDA_CIMA_DIAGONAL_BACKUP:
    MOV CX, DI
    JMP PROCURA_PALAVRA_ESQUERDA_CIMA_DIAGONAL
PROCURANDO_ESQUERDA_CIMA_DIAGONAL_M:
    MOV DL, [SI] 
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL
    CMP DI, "@"
    JE  PROXIMA_LINHA_ESQUERDA_CIMA_DIAGONAL
    CMP DH, "*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL
    CMP DH,DL
    JE  ESQUERDA_CIMA_DIAGONAL_BACKUP
    INC DI
    MOV SI, OFFSET PALAVRA
    JMP PROCURANDO_ESQUERDA_CIMA_DIAGONAL_M 
PROCURA_PALAVRA_ESQUERDA_CIMA_DIAGONAL:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL
    CMP DI, "@"
    JE  PROXIMA_LINHA_ESQUERDA_CIMA_DIAGONAL  
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_ESQUERDA_CIMA_DIAGONAL_IGUAIS
    MOV DI, CX
    INC DI
    MOV SI, OFFSET PALAVRA  
    JMP PROCURANDO_ESQUERDA_CIMA_DIAGONAL_M
IGUAL_PARCIAL_PROCURANDO_ESQUERDA_CIMA_DIAGONAL_IGUAIS:
    INC SI
    ADD DI, 43
    JMP PROCURA_PALAVRA_ESQUERDA_CIMA_DIAGONAL
ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL:
    MOV AH,2
    MOV DL,"S"
    INT 21H
    JMP FIM_PROCURA_ESQUERDA_CIMA_DIAGONAL
NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL:
    MOV AH,2
    MOV DL,"N"
    INT 21H
FIM_PROCURA_ESQUERDA_CIMA_DIAGONAL:
    POP CX
    POP DX 
    POPF
    RET

    
PROCURA_DIREITA_CIMA_DIAGONAL:
    PUSHF  
    PUSH DX
    PUSH CX
    PUSH BX
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET DIFICIL_A
    MOV CX, DI            
    JMP PROCURANDO_DIREITA_CIMA_DIAGONAL_M
PROXIMA_LINHA_DIREITA_CIMA_DIAGONAL:
    ADD CX, 2
    MOV DI, CX                           
    CMP DI, "*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL
    MOV SI, OFFSET PALAVRA
    JMP PROCURANDO_DIREITA_CIMA_DIAGONAL_M
DIREITA_CIMA_DIAGONAL_BACKUP:
    MOV BX, DI 
    JMP PROCURA_PALAVRA_DIREITA_CIMA_DIAGONAL
PROCURANDO_DIREITA_CIMA_DIAGONAL_M:
    MOV DL, [SI] 
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL
    CMP DH, "@"
    JE  PROXIMA_LINHA_DIREITA_CIMA_DIAGONAL
    CMP DH, "*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL
    CMP DH,DL
    JE  DIREITA_CIMA_DIAGONAL_BACKUP
    INC DI
    MOV SI, OFFSET PALAVRA
    JMP PROCURANDO_DIREITA_CIMA_DIAGONAL_M 
PROCURA_PALAVRA_DIREITA_CIMA_DIAGONAL:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL
    CMP DH, "@"
    JE  PROXIMA_LINHA_DIREITA_CIMA_DIAGONAL  
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_DIREITA_CIMA_DIAGONAL_IGUAIS
    MOV DI, BX
    INC DI
    MOV SI, OFFSET PALAVRA  
    JMP PROCURANDO_DIREITA_CIMA_DIAGONAL_M
IGUAL_PARCIAL_PROCURANDO_DIREITA_CIMA_DIAGONAL_IGUAIS:
    INC SI
    ADD DI, 41
    JMP PROCURA_PALAVRA_DIREITA_CIMA_DIAGONAL
ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL:
    MOV AH,2
    MOV DL,"S"
    INT 21H
    JMP FIM_PROCURA_DIREITA_CIMA_DIAGONAL
NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL:
    MOV AH,2
    MOV DL,"N"
    INT 21H
FIM_PROCURA_DIREITA_CIMA_DIAGONAL:
    POP BX
    POP CX
    POP DX
    POPF                           
    RET
    
PROCURA_DIREITA_BAIXO_DIAGONAL:
    PUSHF 
    PUSH DX
    PUSH BX
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_B
    ADD DI, 40 
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_M
DIREITA_BAIXO_DIAGONAL_BACKUP:
    MOV BX, DI
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_PALAVRA 
PROCURANDO_DIREITA_BAIXO_DIAGONAL_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL 
    CMP DH, "$"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL
    CMP DH,DL
    JE  DIREITA_BAIXO_DIAGONAL_BACKUP
    MOV SI, OFFSET PALAVRA
    DEC DI
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_M
PROCURANDO_DIREITA_BAIXO_DIAGONAL_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL 
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_DIREITA_BAIXO_DIAGONAL_IGUAIS
    MOV SI, OFFSET PALAVRA
    MOV DI, BX
    DEC DI
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_M
IGUAL_PARCIAL_PROCURANDO_DIREITA_BAIXO_DIAGONAL_IGUAIS:
    INC SI
    SUB DI, 43
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_PALAVRA
ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL:
    MOV AH,2
    MOV DL,"S"
    INT 21H
    JMP FIM_PROCURA_DIREITA_BAIXO_DIAGONAL
NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL:
    MOV AH,2
    MOV DL,"N"
    INT 21H
FIM_PROCURA_DIREITA_BAIXO_DIAGONAL: 
    POP BX
    POP DX
    POPF
    RET
    

PROCURA_ESQUERDA_BAIXO_DIAGONAL:
    PUSHF 
    PUSH DX   
    PUSH BX 
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_B
    ADD DI, 40
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_M
ESQUERDA_BAIXO_DIAGONAL_PUSH:
    MOV BX, DI
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_PALAVRA 
PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL 
    CMP DH, "$"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL
    CMP DH,DL
    JE  ESQUERDA_BAIXO_DIAGONAL_PUSH
    MOV SI, OFFSET PALAVRA
    DEC DI
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_M
PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL 
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_IGUAIS
    MOV SI, OFFSET PALAVRA
    MOV DI, BX
    DEC DI
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_M
IGUAL_PARCIAL_PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_IGUAIS:
    INC SI
    SUB DI, 41
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_PALAVRA
ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL:
    MOV AH,2
    MOV DL,"S"
    INT 21H
    JMP FIM_PROCURA_ESQUERDA_BAIXO_DIAGONAL
NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL:
    MOV AH,2
    MOV DL,"N"
    INT 21H
FIM_PROCURA_ESQUERDA_BAIXO_DIAGONAL: 
    POP BX
    POP DX
    POPF
    RET    

    
PULA_LINHA:                      
    PUSHF
    PUSH AX
    PUSH DX
    MOV AH,2
    MOV DL,13        
    INT 21H
    MOV AH,2
    MOV DL,10
    INT 21H
    POP DX        
    POP AX
    POPF
    RET
 

PALAVRA DB TAMANHO DUP(" "),0  

                                                       
;use qualquer marcador                                                          
;fixo 10x40
         DB 0,"#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@"
INICIO_A DB   "!MSJDFLKASJDKFLJSADKLFJAKLSJDFKLASJDFKJMM@"
         DB   "!AIJDFLKASJDKFLJSADKLFJAKLSJDFKLASJDFKIII@"
         DB   "!ALGKDFJKLASDJFLKSAJDKFLJSADKLFJLKDSAGGLG@"
         DB   "!ASJUFLKASMIGUELJSADKLFJAKLSJDFKLESJUUKJU@"
         DB   "!ALLKELDFASDDJFLKSAJDKFLJSADKLFJLKUEEJFLE@"
         DB   "!ASEDELKASJDKFLJSADKLFJAKLSJDFKLASLGGKJSL@"
         DB   "!ALUUDFJKLASDJFLKSAJDKFLJSADKLFJLKDSIJFLK@"
         DB   "!ASGDFLKASJDKFLJSADKLFJAKLSJDFKLASJDEMJSA@"
         DB   "!AIIKDFJKLASDJFLKSAJDKFLJSALEUGIMKDSLJFLK@"
INICIO_B DB   "!MSMMFLKASJDKFLJSADKLFJAKLSJDFKLASJDFKJSA@"
         DB   "*****************************************#",0